image: node:16
pipelines:
    default:
        - step:
              name: Build and Push push to nexus server
              caches:
                  - node
              script:
                  - npm install --legacy-peer-deps
                  - npm run publish
                  #   - docker login http://project.pilgrimconsulting.group:8081 --username admin --password admin123
                  #   - docker build -t serviceAccount:sentinel-fronend:latest .
                  #   - docker push serviceAccount:sentinel-fronend:latest
                  - pipe: sonatype/nexus-repository-publish:0.0.1
                    variables:
                        FILENAME: "sentinel/frontend:latest"
                        ATTRIBUTES: "-CgroupId=com.example -CartifactId=myapp -Cversion=1.0 -Aextension=jar"
                        USERNAME: "admin"
                        PASSWORD: "admin123"
                        SERVER_URL: "http://project.pilgrimconsulting.group/"
              artifacts:
                  - node_modules/**
              services:
                  - docker
        # - step:
        #     name: Deploy to Kubernetes
        #     deployment: production
        #     script:
        #       - pipe: atlassian/google-gke-kubectl-run:1.3.1
        #         variables:
        #           KEY_FILE: $KUBE_CONFIG
        #           PROJECT: "wn-crs"
        #           COMPUTE_ZONE: "us-central1-c"
        #           CLUSTER_NAME: "cluster-1"
        #           KUBECTL_COMMAND: "apply"
        #           RESOURCE_PATH: "deployment.yml
